# Migration `20210401131525-add`

This migration has been generated by ahmed nasr at 4/1/2021, 3:15:25 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Course" (
"id" text   NOT NULL ,
"price" integer   NOT NULL ,
"patientId" text   NOT NULL ,
"userId" text   NOT NULL ,
"courseDefinitionId" text   NOT NULL ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."Course" ADD FOREIGN KEY ("patientId")REFERENCES "public"."Patient"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Course" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Course" ADD FOREIGN KEY ("courseDefinitionId")REFERENCES "public"."CourseDefinition"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210401075855-update-the-course-modal..20210401131525-add
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -14,9 +14,9 @@
   Session
   Surgery
 }
-enum CourseType{
+enum CourseType {
   session
   perunit
 }
@@ -152,8 +152,9 @@
   timing              Timing[]
   labCategories       LabCategory[]
   imageCategories     ImageCategory[]
   CourseDefinition    CourseDefinition[]
+  Course              Course[]
 }
 model Patient {
   id               String                @id @default(uuid())
@@ -173,8 +174,9 @@
   inventoryHistory InventoryHistory[]
   patientSurgeries PatientSurgery[]
   labs             Lab[]
   images           Image[]
+  Course           Course[]
 }
 model Appointment {
   id               String             @id @default(uuid())
@@ -495,18 +497,30 @@
   Image    Image[]
 }
 model CourseDefinition {
-  id             String @id @default(uuid())
+  id             String     @id @default(uuid())
   name           String
   type           CourseType
   price          Int
   units          Int
   messureOfUnits String
-  user           User   @relation(fields: [userId], references: [id])
+  user           User       @relation(fields: [userId], references: [id])
   userId         String
+  Course         Course[]
 }
+model Course {
+  id                 String           @id @default(uuid())
+  price              Int
+  patient            Patient          @relation(fields: [patientId], references: [id])
+  patientId          String
+  user               User             @relation(fields: [userId], references: [id])
+  userId             String
+  courseDefinition   CourseDefinition @relation(fields: [courseDefinitionId], references: [id])
+  courseDefinitionId String
+}
+
 model ImageCategory {
   id     String @id @default(uuid())
   name   String
   user   User   @relation(fields: [userId], references: [id])
@@ -565,9 +579,8 @@
   Specialty
   User
 }
-
 model PermissionRole {
   id             String       @id @default(uuid())
   name           String
   organization   Organization @relation(fields: [organizationId], references: [id])
```



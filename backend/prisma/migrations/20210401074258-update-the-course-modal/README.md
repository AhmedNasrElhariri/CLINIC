# Migration `20210401074258-update-the-course-modal`

This migration has been generated by ahmed nasr at 4/1/2021, 9:42:59 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."CourseType" AS ENUM ('session', 'perunit')

ALTER TABLE "public"."ImageDocument" DROP CONSTRAINT "ImageDocument_fileId_fkey"

ALTER TABLE "public"."ImageDocument" DROP CONSTRAINT "ImageDocument_imageId_fkey"

ALTER TABLE "public"."LabDocument" DROP CONSTRAINT "LabDocument_fileId_fkey"

ALTER TABLE "public"."LabDocument" DROP CONSTRAINT "LabDocument_labId_fkey"

ALTER TABLE "public"."CourseDefinition" ADD COLUMN "messureOfUnits" text   NOT NULL ,
DROP COLUMN "type",
ADD COLUMN "type" "CourseType"  NOT NULL 

CREATE TABLE "public"."_FileToLab" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_FileToImage" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE UNIQUE INDEX "_FileToLab_AB_unique" ON "public"."_FileToLab"("A", "B")

CREATE INDEX "_FileToLab_B_index" ON "public"."_FileToLab"("B")

CREATE UNIQUE INDEX "_FileToImage_AB_unique" ON "public"."_FileToImage"("A", "B")

CREATE INDEX "_FileToImage_B_index" ON "public"."_FileToImage"("B")

ALTER TABLE "public"."_FileToLab" ADD FOREIGN KEY ("A")REFERENCES "public"."File"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FileToLab" ADD FOREIGN KEY ("B")REFERENCES "public"."Lab"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FileToImage" ADD FOREIGN KEY ("A")REFERENCES "public"."File"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FileToImage" ADD FOREIGN KEY ("B")REFERENCES "public"."Image"("id") ON DELETE CASCADE ON UPDATE CASCADE

DROP TABLE "public"."ImageDocument"

DROP TABLE "public"."LabDocument"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210327232851-remove-doc..20210401074258-update-the-course-modal
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -14,8 +14,13 @@
   Session
   Surgery
 }
+enum CourseType{
+  session
+  perunit
+}
+
 enum LabStatus {
   Draft
   Pending
   Completed
@@ -146,8 +151,9 @@
   item                Item[]
   timing              Timing[]
   labCategories       LabCategory[]
   imageCategories     ImageCategory[]
+  CourseDefinition    CourseDefinition[]
 }
 model Patient {
   id               String                @id @default(uuid())
@@ -488,8 +494,19 @@
   userId   String
   Image    Image[]
 }
+model CourseDefinition {
+  id             String @id @default(uuid())
+  name           String
+  type           CourseType
+  price          String
+  units          String
+  messureOfUnits String
+  user           User   @relation(fields: [userId], references: [id])
+  userId         String
+}
+
 model ImageCategory {
   id     String @id @default(uuid())
   name   String
   user   User   @relation(fields: [userId], references: [id])
@@ -548,8 +565,9 @@
   Specialty
   User
 }
+
 model PermissionRole {
   id             String       @id @default(uuid())
   name           String
   organization   Organization @relation(fields: [organizationId], references: [id])
```



# Migration `20210131001655-speciality`

This migration has been generated by etahoon at 1/31/2021, 2:16:55 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."SpecialtyUser" DROP CONSTRAINT "SpecialtyUser_branchId_fkey"

ALTER TABLE "public"."SpecialtyUser" DROP CONSTRAINT "SpecialtyUser_organizationId_fkey"

ALTER TABLE "public"."SpecialtyUser" DROP CONSTRAINT "SpecialtyUser_specialtyId_fkey"

ALTER TABLE "public"."SpecialtyUser" DROP CONSTRAINT "SpecialtyUser_userId_fkey"

CREATE TABLE "public"."UserSpecialty" (
"id" text   NOT NULL ,
"branchId" text   NOT NULL ,
"specialtyId" text   NOT NULL ,
"userId" text   NOT NULL ,
"organizationId" text   NOT NULL ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."UserSpecialty" ADD FOREIGN KEY ("branchId")REFERENCES "public"."Branch"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."UserSpecialty" ADD FOREIGN KEY ("specialtyId")REFERENCES "public"."Specialty"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."UserSpecialty" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."UserSpecialty" ADD FOREIGN KEY ("organizationId")REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE

DROP TABLE "public"."SpecialtyUser"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210130233049-add-user-to-speciality..20210131001655-speciality
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -64,21 +64,21 @@
 ////////////////////////////////////////////////////////////////////////////////////////////////////////
 model Organization {
-  id             String           @id @default(uuid())
-  name           String
-  item           Item[]
-  hospital       Hospital[]
-  surgery        Surgery[]
-  patientSurgery PatientSurgery[]
-  roles          PermissionRole[]
-  permissions    Permission[]
-  rules          Rule[]
-  branchs        Branch[]
-  specialties    Specialty[]
-  users          User[]
-  specialtyUsers SpecialtyUser[]
+  id              String           @id @default(uuid())
+  name            String
+  item            Item[]
+  hospital        Hospital[]
+  surgery         Surgery[]
+  patientSurgery  PatientSurgery[]
+  roles           PermissionRole[]
+  permissions     Permission[]
+  rules           Rule[]
+  branchs         Branch[]
+  specialties     Specialty[]
+  users           User[]
+  userSpecialties UserSpecialty[]
 }
 model User {
   id               String             @id @default(uuid())
@@ -98,9 +98,9 @@
   position         Position
   events           Event[]
   inventoryHistory InventoryHistory[]
   rules            Rule[]
-  specialtyUsers   SpecialtyUser[]
+  userSpecialties  UserSpecialty[]
 }
 model Patient {
   id               String                @id @default(uuid())
@@ -462,31 +462,31 @@
   permissionId   String
 }
 model Branch {
-  id             String          @id @default(uuid())
-  name           String
-  address        String?
-  phoneNo        String?
-  notes          String?
-  organization   Organization    @relation(fields: [organizationId], references: [id])
-  organizationId String
-  rules          Rule[]
-  specialties    Specialty[]
-  specialtyUsers SpecialtyUser[]
+  id              String          @id @default(uuid())
+  name            String
+  address         String?
+  phoneNo         String?
+  notes           String?
+  organization    Organization    @relation(fields: [organizationId], references: [id])
+  organizationId  String
+  rules           Rule[]
+  specialties     Specialty[]
+  userSpecialties UserSpecialty[]
 }
 model Specialty {
-  id             String          @id @default(uuid())
-  name           String
-  organization   Organization    @relation(fields: [organizationId], references: [id])
-  organizationId String
-  rules          Rule[]
-  branches       Branch[]
-  specialtyUsers SpecialtyUser[]
+  id              String          @id @default(uuid())
+  name            String
+  organization    Organization    @relation(fields: [organizationId], references: [id])
+  organizationId  String
+  rules           Rule[]
+  branches        Branch[]
+  userSpecialties UserSpecialty[]
 }
-model SpecialtyUser {
+model UserSpecialty {
   id             String       @id @default(uuid())
   branch         Branch       @relation(fields: [branchId], references: [id])
   branchId       String
   specialty      Specialty    @relation(fields: [specialtyId], references: [id])
```



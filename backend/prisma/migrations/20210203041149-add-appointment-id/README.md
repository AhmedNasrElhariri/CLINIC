# Migration `20210203041149-add-appointment-id`

This migration has been generated by etahoon at 2/3/2021, 6:11:49 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."PatientSurgery" ADD COLUMN "appointmentId" text   

ALTER TABLE "public"."PatientSurgery" ADD FOREIGN KEY ("appointmentId")REFERENCES "public"."Appointment"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210201173148-chagne-medical-to-medeicne..20210203041149-add-appointment-id
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -112,24 +112,25 @@
   patientSurgery   PatientSurgery[]
 }
 model Appointment {
-  id           String             @id @default(uuid())
-  date         DateTime           @default(now())
-  type         AppointmentType
-  patient      Patient            @relation(fields: [patientId], references: [id])
-  patientId    String
-  specialty    Specialty
-  doctor       User               @relation(fields: [doctorId], references: [id])
-  doctorId     String
-  labs         String?            @default("[]")
-  status       AppointmentStatus
-  data         AppointmentField[]
-  collections  Collection[]
-  clinic       Clinic             @relation(fields: [clinicId], references: [id])
-  clinicId     String
-  notes        String?            @default("")
-  prescription String?            @default("")
+  id               String             @id @default(uuid())
+  date             DateTime           @default(now())
+  type             AppointmentType
+  patient          Patient            @relation(fields: [patientId], references: [id])
+  patientId        String
+  specialty        Specialty
+  doctor           User               @relation(fields: [doctorId], references: [id])
+  doctorId         String
+  labs             String?            @default("[]")
+  status           AppointmentStatus
+  data             AppointmentField[]
+  collections      Collection[]
+  clinic           Clinic             @relation(fields: [clinicId], references: [id])
+  clinicId         String
+  notes            String?            @default("")
+  prescription     String?            @default("")
+  patientSurgeries PatientSurgery[]
 }
 model View {
   id                  String          @id @default(uuid())
@@ -405,8 +406,10 @@
   surgery        Surgery      @relation(fields: [surgeryId], references: [id])
   surgeryId      String
   hospital       Hospital     @relation(fields: [hospitalId], references: [id])
   hospitalId     String
+  appointment    Appointment? @relation(fields: [appointmentId], references: [id])
+  appointmentId  String?
   organization   Organization @relation(fields: [organizationId], references: [id])
   organizationId String
   date           DateTime
   fees           Int?
```



# Migration `20210313104045-add-prescription`

This migration has been generated by etahoon at 3/13/2021, 12:40:46 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Appointment" DROP CONSTRAINT "Appointment_prescriptionId_fkey"

ALTER TABLE "public"."Appointment" DROP COLUMN "prescriptionId"

ALTER TABLE "public"."Prescription" ADD COLUMN "appointmentId" text   

ALTER TABLE "public"."Prescription" ADD FOREIGN KEY ("appointmentId")REFERENCES "public"."Appointment"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210311005336-images-for-appts..20210313104045-add-prescription
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -183,24 +183,24 @@
   data             AppointmentField[]
   collections      Collection[]
   notes            String?            @default("")
   patientSurgeries PatientSurgery[]
-  prescription     Prescription?      @relation(fields: [prescriptionId], references: [id])
-  prescriptionId   String?
   appointmentLabId String?
   labs             Lab[]
   images           Image[]
+  prescription     Prescription[]
 }
 model Prescription {
-  id             String        @id @default(uuid())
-  medicine       Patient       @relation(fields: [medicineId], references: [id])
+  id             String       @id @default(uuid())
+  medicine       Patient      @relation(fields: [medicineId], references: [id])
   medicineId     String
-  timing         Timing        @relation(fields: [timingId], references: [id])
+  timing         Timing       @relation(fields: [timingId], references: [id])
   timingId       String
   durationLength Int
   durationType   String
-  appointments   Appointment[]
+  appointment    Appointment? @relation(fields: [appointmentId], references: [id])
+  appointmentId  String?
 }
 model View {
   id                  String          @id @default(uuid())
```



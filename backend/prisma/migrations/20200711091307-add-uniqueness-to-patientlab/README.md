# Migration `20200711091307-add-uniqueness-to-patientlab`

This migration has been generated by etahoon at 7/11/2020, 9:13:07 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Clinic" ALTER COLUMN "address" SET DEFAULT '',
ALTER COLUMN "doctorJobDescription" SET DEFAULT '',
ALTER COLUMN "doctorName" SET DEFAULT '',
ALTER COLUMN "doctorTitle" SET DEFAULT '',
ALTER COLUMN "phoneNo" SET DEFAULT '';

CREATE UNIQUE INDEX "name_patientId_unique_constraint" ON "public"."PatientLab"("name","patientId")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200711075029-fix-patient-typo..20200711091307-add-uniqueness-to-patientlab
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -200,13 +200,14 @@
   body   String
 }
 model PatientLab {
-  id           String        @default(uuid()) @id
-  patient      Patient       @relation(fields: [patientId], references: [id])
-  patientId    String
-  name         String
+  id        String        @default(uuid()) @id
+  patient   Patient       @relation(fields: [patientId], references: [id])
+  patientId String
+  name      String
   documents LabDocument[]
+  @@unique([name, patientId], name: "name_patientId_unique_constraint")
 }
 model LabDocument {
   id           String     @default(uuid()) @id
```



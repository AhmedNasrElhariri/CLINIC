# Migration `20200425125700-alter-uuid-to-string`

This migration has been generated by etahoon at 4/25/2020, 12:57:00 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP TABLE "public"."Appointment";

DROP TABLE "public"."Patient";

DROP TABLE "public"."User";

CREATE TYPE "AppointmentType" AS ENUM ('Examination', 'Followup');

CREATE TYPE "Sex" AS ENUM ('Female', 'Male');

CREATE TYPE "Specialty" AS ENUM ('Dentistry');

CREATE TYPE "PatientMembershipType" AS ENUM ('Primary', 'Secondary');

CREATE TABLE "public"."User" (
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    "specialty" "Specialty" NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Patient" (
    "age" integer  NOT NULL ,
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    "phoneNo" text  NOT NULL ,
    "sex" "Sex" NOT NULL ,
    "type" "PatientMembershipType" NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Appointment" (
    "archived" boolean  NOT NULL DEFAULT false,
    "complain" text   DEFAULT '',
    "date" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "diagnosis" text   DEFAULT '',
    "doctorId" text  NOT NULL ,
    "glucoseLevel" Decimal(65,30)   DEFAULT -1,
    "height" Decimal(65,30)   DEFAULT -1,
    "id" text  NOT NULL ,
    "labs" text   DEFAULT '[]',
    "patientId" text  NOT NULL ,
    "pulse" Decimal(65,30)   DEFAULT -1,
    "recommendations" text   DEFAULT '',
    "signs" text   DEFAULT '',
    "specialty" "Specialty" NOT NULL ,
    "temp" Decimal(65,30)   DEFAULT -1,
    "treatment" text   DEFAULT '',
    "type" "AppointmentType" NOT NULL ,
    "weight" Decimal(65,30)   DEFAULT -1,
    PRIMARY KEY ("id")
) 

CREATE UNIQUE INDEX "Patient.phoneNo" ON "public"."Patient"("phoneNo")

CREATE UNIQUE INDEX "Appointment.date" ON "public"."Appointment"("date")

ALTER TABLE "public"."Appointment" ADD FOREIGN KEY ("patientId")REFERENCES "public"."Patient"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Appointment" ADD FOREIGN KEY ("doctorId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200425125603-alter-id-type-to-uuid..20200425125700-alter-uuid-to-string
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs https//pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -29,15 +29,15 @@
   Secondary
 }
 model User {
-  id                 Int @default(uuid()) @id
+  id                 String @default(uuid()) @id
   name               String
   specialty          Specialty
 }
 model Patient {
-  id                 Int @default(uuid()) @id
+  id                 String @default(uuid()) @id
   name               String
   phoneNo            String @unique
   type               PatientMembershipType
   appointments       Appointment[]
@@ -45,16 +45,16 @@
   sex                Sex
 }
 model Appointment {
-  id                 Int @default(uuid()) @id
+  id                 String @default(uuid()) @id
   date               DateTime @unique @default(now())
   type               AppointmentType
   patient            Patient @relation(fields: [patientId], references: [id])
-  patientId          Int
+  patientId          String
   specialty          Specialty
   doctor             User @relation(fields: [doctorId], references: [id])
-  doctorId           Int 
+  doctorId           String 
   labs               String? @default("[]")
   complain           String? @default("")
   signs              String? @default("")
   diagnosis          String? @default("")
```



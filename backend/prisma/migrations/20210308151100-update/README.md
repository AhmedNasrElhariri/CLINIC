# Migration `20210308151100-update`

This migration has been generated by ahmed nasr at 3/8/2021, 5:11:00 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."LabDocument" DROP COLUMN "name",
ADD COLUMN "labDefinitionId" text   ,
ADD COLUMN "testDefinitionId" text   NOT NULL 

ALTER TABLE "public"."LabDocument" ADD FOREIGN KEY ("testDefinitionId")REFERENCES "public"."TestDefinition"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210308130613-add-field..20210308151100-update
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -317,17 +317,19 @@
   body   String
 }
 model LabDocument {
-  id           String       @id @default(uuid())
-  name         String
-  file         File?        @relation(fields: [fileId], references: [id])
-  fileId       String?
-  status       LabDocStatus
-  requiredDate DateTime     @default(now())
-  resultDate   DateTime?
-  value        String?
-  patientId    String
+  id               String         @id @default(uuid())
+  labDefinition    TestDefinition @relation(fields: [testDefinitionId], references: [id])
+  labDefinitionId  String?
+  file             File?          @relation(fields: [fileId], references: [id])
+  fileId           String?
+  status           LabDocStatus
+  requiredDate     DateTime       @default(now())
+  resultDate       DateTime?
+  value            String?
+  patientId        String
+  testDefinitionId String
 }
 model MedicineHistory {
   id           String    @id @default(uuid())
@@ -453,8 +455,9 @@
   category       String
   user           User             @relation(fields: [userId], references: [id])
   userId         String
   AppointmentLab AppointmentLab[]
+  LabDocument    LabDocument[]
 }
 model LabCategory {
   id     String @id @default(uuid())
```



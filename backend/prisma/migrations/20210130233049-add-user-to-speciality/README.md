# Migration `20210130233049-add-user-to-speciality`

This migration has been generated by etahoon at 1/31/2021, 1:30:49 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."SpecialtyUser" (
"id" text   NOT NULL ,
"branchId" text   NOT NULL ,
"specialtyId" text   NOT NULL ,
"userId" text   NOT NULL ,
"organizationId" text   NOT NULL ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."SpecialtyUser" ADD FOREIGN KEY ("branchId")REFERENCES "public"."Branch"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."SpecialtyUser" ADD FOREIGN KEY ("specialtyId")REFERENCES "public"."Specialty"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."SpecialtyUser" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."SpecialtyUser" ADD FOREIGN KEY ("organizationId")REFERENCES "public"."Organization"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210130122520-change-user-organization-realtionships..20210130233049-add-user-to-speciality
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -76,8 +76,9 @@
   rules          Rule[]
   branchs        Branch[]
   specialties    Specialty[]
   users          User[]
+  specialtyUsers SpecialtyUser[]
 }
 model User {
   id               String             @id @default(uuid())
@@ -85,20 +86,21 @@
   email            String             @unique
   password         String
   organization     Organization       @relation(fields: [organizationId], references: [id])
   organizationId   String
-  appointment      Appointment[]
-  view             View[]
+  appointments     Appointment[]
+  views            View[]
   viewStatus       ViewStatus[]
   clinics          Clinic[]           @relation(references: [id])
   workingHours     WorkingHours[]
-  snippet          Snippet[]
+  snippets         Snippet[]
   permissions      Json               @default("[]")
   avatar           String?
   position         Position
   events           Event[]
   inventoryHistory InventoryHistory[]
-  Rule             Rule[]
+  rules            Rule[]
+  specialtyUsers   SpecialtyUser[]
 }
 model Patient {
   id               String                @id @default(uuid())
@@ -460,28 +462,42 @@
   permissionId   String
 }
 model Branch {
-  id             String       @id @default(uuid())
+  id             String          @id @default(uuid())
   name           String
   address        String?
   phoneNo        String?
   notes          String?
-  organization   Organization @relation(fields: [organizationId], references: [id])
+  organization   Organization    @relation(fields: [organizationId], references: [id])
   organizationId String
   rules          Rule[]
   specialties    Specialty[]
+  specialtyUsers SpecialtyUser[]
 }
 model Specialty {
-  id             String       @id @default(uuid())
+  id             String          @id @default(uuid())
   name           String
-  organization   Organization @relation(fields: [organizationId], references: [id])
+  organization   Organization    @relation(fields: [organizationId], references: [id])
   organizationId String
   rules          Rule[]
   branches       Branch[]
+  specialtyUsers SpecialtyUser[]
 }
+model SpecialtyUser {
+  id             String       @id @default(uuid())
+  branch         Branch       @relation(fields: [branchId], references: [id])
+  branchId       String
+  specialty      Specialty    @relation(fields: [specialtyId], references: [id])
+  specialtyId    String
+  user           User         @relation(fields: [userId], references: [id])
+  userId         String
+  organization   Organization @relation(fields: [organizationId], references: [id])
+  organizationId String
+}
+
 model Action {
   id          String       @id @default(uuid())
   name        String
   subject     String
```



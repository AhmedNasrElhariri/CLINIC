# Migration `20201022053405-appointment-images`

This migration has been generated by etahoon at 10/22/2020, 7:34:05 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."File" ADD COLUMN "comment" text   ,
ADD COLUMN "collectionId" text   

CREATE TABLE "public"."Collection" (
"id" text   NOT NULL ,
"appointmentId" text   NOT NULL ,
"caption" text   NOT NULL DEFAULT E'',
PRIMARY KEY ("id")
)

ALTER TABLE "public"."Collection" ADD FOREIGN KEY ("appointmentId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."File" ADD FOREIGN KEY ("collectionId")REFERENCES "public"."Collection"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201007002554-init..20201022053405-appointment-images
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -161,15 +161,18 @@
   @@unique([appointmentId, fieldId], name: "appointment_fieldId_unique_constraint")
 }
 model File {
-  id          String        @id @default(uuid())
-  url         String
-  filename    String
-  mimetype    String?
-  encoding    String?
-  Clinic      Clinic[]
-  LabDocument LabDocument[]
+  id                String        @id @default(uuid())
+  url               String
+  filename          String
+  comment           String?
+  collection        Collection?     @relation(fields: [collectionId], references: [id])
+  collectionId      String?
+  mimetype          String?
+  encoding          String?
+  Clinic            Clinic[]
+  LabDocument       LabDocument[]
 }
 model Clinic {
   id                String  @id @default(uuid())
@@ -296,11 +299,18 @@
   date       DateTime @default(now())
 }
 model Event {
-  id     String   @id @default(uuid())
-  user   User     @relation(fields: [userId], references: [id])
-  userId String
-  name   String
-  start  DateTime
-  end    DateTime
+  id         String   @id @default(uuid())
+  user       User     @relation(fields: [userId], references: [id])
+  userId     String
+  name       String
+  start      DateTime
+  end        DateTime
 }
+
+model Collection {
+  id              String   @id @default(uuid())
+  appointment     User     @relation(fields: [appointmentId], references: [id])
+  appointmentId   String
+  caption         String   @default("")
+}
```


